STEP 1: Inspect Raw Data
Understand the schema before querying:
SELECT *
FROM job_postings_fact
LIMIT 10;
SELECT
job_id,
job_title,
job_location,
job_schedule_type,
job_work_from_home,
salary_year_avg,
job_posted_date
FROM job_postings_fact
WHERE salary_year_avg IS NOT NULL;
Why: Shows you inspect schemas + remove junk data first.
STEP 2: Filter to Relevant Roles
Focus on one role with complete salary data:
SELECT
job_id,
job_title,
job_location,
job_work_from_home,
salary_year_avg
FROM job_postings_fact
WHERE
salary_year_avg IS NOT NULL
AND job_title_short = 'Data Analyst'
AND job_work_from_home = 'True'
ORDER BY
salary_year_avg DESC;
What This Proves:
Filtering on multiple conditions
Removing nulls (data quality)
Focusing on profitable segment
 STEP 3: Top-Paying Data Analyst Jobs
SELECT
job_id,
job_title,
job_location,
job_schedule_type,
job_work_from_home,
salary_year_avg
FROM job_postings_fact
WHERE
salary_year_avg IS NOT NULL
AND job_title_short = 'Data Analyst'
AND job_work_from_home = 'True'
ORDER BY
salary_year_avg DESC
LIMIT 10;
STEP 4: Most In-Demand Skills (JOIN)
Use multi-table JOINs to connect jobs + skills:
SELECT
s.skills,
COUNT(sj.job_id) AS demand_count
FROM job_postings_fact j
INNER JOIN skills_job_dim sj
ON j.job_id = sj.job_id
INNER JOIN skills_dim s
ON sj.skill_id = s.skill_id
WHERE
j.job_title_short = 'Data Analyst'
AND j.job_work_from_home = 'True'
GROUP BY s.skills
ORDER BY demand_count DESC
LIMIT 10;
Results Show:
SQL appears in 8,000+ job posts
Excel in 6,500+ posts
 Python in 4,200+ posts
What This Proves:
Multi-table JOINs (critical skill)
 GROUP BY + COUNT aggregates
 Business insight extraction
STEP 5: Highest-Paying Skills (Aggregate + JOIN)
SELECT s.skills,
ROUND(AVG(j.salary_year_avg), 0) AS avg_salary,
COUNT(sj.job_id) AS job_count
FROM job_postings_fact j
INNER JOIN skills_job_dim sj
ON j.job_id = sj.job_id
INNER JOIN skills_dim s
ON sj.skill_id = s.skill_id
WHERE
j.job_title_short = 'Data Analyst'
AND j.job_work_from_home = 'True'
AND j.salary_year_avg IS NOT NULL
GROUP BY s.skills
ORDER BY avg_salary DESC LIMIT 25;
Results Show:
Python roles: $95,000 avg
Tableau roles: $92,500 avg
 Power BI roles: $90,000 avg
SQL roles: $88,000 avg
What This Proves:
ROUND() for clean currency
Multiple aggregates (COUNT + AVG)
Salary analysis capability
 STEP 6: OPTIMAL Skills (Demand + Salary - THE
STAR QUERY)
Use CTEs to find skills that are BOTH in-demand AND high-paying:
WITH skills_demand AS (
SELECT
s.skill_id,
s.skills,
COUNT(sj.job_id) AS demand_count
FROM job_postings_fact j
INNER JOIN skills_job_dim sj
ON j.job_id = sj.job_id
INNER JOIN skills_dim s
ON sj.skill_id = s.skill_id
WHERE
j.job_title_short = 'Data Analyst'
AND j.job_work_from_home = 'True'
GROUP BY
s.skill_id, s.skills
),
skills_salary AS (
SELECT
s.skill_id,
s.skills,
ROUND(AVG(j.salary_year_avg), 0) AS avg_salary
FROM job_postings_fact j
INNER JOIN skills_job_dim sj
ON j.job_id = sj.job_id
INNER JOIN skills_dim s
ON sj.skill_id = s.skill_id
WHERE
j.job_title_short = 'Data Analyst'
AND j.job_work_from_home = 'True'
AND j.salary_year_avg IS NOT NULL
GROUP BY
s.skill_id, s.skills
)
SELECT

d.skills,
d.demand_count,
s.avg_salary,
ROUND((d.demand_count * s.avg_salary / 1000), 0) AS opportunity_score
FROM skills_demand d
LEFT JOIN skills_salary s
ON d.skill_id = s.skill_id
WHERE
d.demand_count > 10
ORDER BY
d.demand_count DESC,
s.avg_salary DESC
LIMIT 25;
Results Show:
Skill Demand Avg Salary Opportunity
SQL 8000 88000 704000
Python 4200 95000 399000
Tableau 2800 92500 259000
Power BI 2500 90000 225000
